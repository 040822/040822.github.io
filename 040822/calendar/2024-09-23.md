
## 7zip自动化压缩解压
思路：使用python的subprocess调用7zip命令行主程序

代码：
```python
import os

import subprocess

import sys

  

# 设置默认编码为 UTF-8

sys.stdout.reconfigure(encoding='utf-8')

  

# 设置 7-Zip 可执行文件的路径

seven_zip_path = r"C:\Program Files\7-Zip\7z.exe"

# 获取当前脚本所在的目录路径

source_dir = os.path.dirname(os.path.abspath(__file__))

  

# 检查 7-Zip 可执行文件是否存在

if not os.path.exists(seven_zip_path):

    print("7z.exe 未找到，请检查路径设置。")

    exit(1)

  

# 检查源目录是否存在

if not os.path.exists(source_dir):

    print("源目录未找到，请检查路径设置。")

    exit(1)

password = "114514" # 设置压缩文件的密码
# 测试每一个压缩包
for file_name in os.listdir(source_dir):
    file_path = os.path.join(source_dir, file_name)
    if os.path.isfile(file_path) and file_name.endswith(('.7z', '.zip', '.rar')):

        print(f"正在测试压缩包 {file_path} ...")

        result = subprocess.run([seven_zip_path, 't', file_path ,'-p'+password], capture_output=True, text=True)

        if result.returncode == 0:

            print(f"压缩包 {file_path} 测试通过。")

        else:

            print(f"压缩包 {file_path} 测试失败。")

            print(result.stdout)

            print(result.stderr)

  

print("完成。")

a=input("按任意键退出")
```
PS: vscode代码直接复制到obsidian里好像有点问题。

通过修改subprocess.run内的命令，还可以实现解压、测试等功能，具体命令见7zip帮助文档：
[7z/help-src at master · sparanoid/7z (github.com)](https://github.com/sparanoid/7z/tree/master/help-src)
7zip中文库，但是这里边的帮助文档是html格式，最好还是clone下来在浏览器里看。