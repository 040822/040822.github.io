
## 第一次蒙特卡洛数学危机
起因：将长为1的棒任意地折成3段,3段的长度都不超过0.5的概率为多少？
使用几何概型之后可以轻而易举的算出来，答案为0.25，甚至还可以拓展到一般情况：[将长为1的棒任意地折成三段，求：三段的长度都不超过a（13≤a≤1）的概率．_作业帮 (zuoyebang.com)](https://qb.zuoyebang.com/xfe-question/question/0642da1f610a2312a9da57b07126dc8e.html)

但是有个sb突发奇想，想用蒙特卡洛来解这道题，于是就有了第一次蒙特卡洛数学危机。
代码1：
```python
#思路：三段长度为x、y、1-x-y。先折第一段x，取x为0~1的随机数；再将剩余的长度1-x折为y和1-x-y两段，其中y取0~1-x的随机数
import random

episodes = 10000000
count = 0

for _ in range(episodes):
    x = random.random()
    y = random.random() * (1 - x)
    z = 1 - x - y
    if x <= 0.5 and y <= 0.5 and z <= 0.5:
        count += 1

probability = count / episodes
print(f"三段长度都不超过0.5的概率是: {probability}")
```
结果为：0.1935414，很显然和理论值不一样。
这是为什么呢？问题就出在了“y取0~1-x的随机数”上，这就导致y的概率分布与x相关了，从而导致最终结果出错。按照这种方式进行理论计算，结果为ln2-0.5,和蒙特卡洛的结果一致。

正确的代码：
```python
#代码思路：取木棒上两个折断点a1、a2，然后计算三段的长度x、y、z。
import random

episodes = 10000000
count = 0

for _ in range(episodes):
    a1 = random.random()
    a2 = random.random()
    if a1 > a2:
        a1, a2 = a2, a1
    x = a1
    y = a2 - a1
    z = 1 - a2
    
    
    if x <= 0.5 and y <= 0.5 and z <= 0.5:
        count += 1

probability = count / episodes
print(f"三段长度都不超过0.5的概率是: {probability}")
```
蒙特卡洛结果为0.2499908，符合理论值。